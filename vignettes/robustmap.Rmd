---
title: "robustmap"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{robustmap}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The following code illustrates how to use the robust.quadcount function:

```{r setup,warning=FALSE}
library(magrittr)
library(robustmap)

# Loading burglary data points
burglary <- sf::read_sf(dsn = "../inst/extdata", layer = "burglary")
burglary <- data.frame(x=burglary$lon_m,
                       y=burglary$lat_m)

# Running robust_quadcount with default parameters
burglary_map <- burglary %>% robust.quadcount()

```

Once the function returns, the optimal granularity (in the same unit of the original coordinates) can be retrieved by:

```{r}
burglary_map$opt_granularity
```

The map of burglary counts can be plotted using:

```{r}
# Plotting the final map
terra::plot(burglary_map$counts)
